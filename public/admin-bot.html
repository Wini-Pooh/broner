<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Bot Admin Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .admin-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        .bot-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        .status-badge {
            font-size: 0.9rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
        }
        .btn-action {
            margin: 0.25rem;
        }
        .result-box {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 1rem;
            margin-top: 1rem;
            font-family: monospace;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="bot-card">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>ü§ñ Telegram Bot Admin Panel</h2>
                <span class="status-badge bg-success text-white" id="botStatus">
                    @broner161_bot
                </span>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <h5>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞</h5>
                    <p class="text-muted">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ webhook –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞</p>
                    
                    <button class="btn btn-primary btn-action" onclick="testBot()">
                        üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–æ—Ç–∞
                    </button>
                    
                    <button class="btn btn-success btn-action" onclick="setWebhook()">
                        üîó –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Webhook
                    </button>
                    
                    <button class="btn btn-info btn-action" onclick="getWebhookInfo()">
                        üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Webhook
                    </button>
                </div>

                <div class="col-md-6">
                    <h5>üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h5>
                    <ul class="list-unstyled">
                        <li><strong>Chat ID:</strong> -1002964255391</li>
                        <li><strong>Bot Token:</strong> 8257321025:AAF...</li>
                        <li><strong>–§—É–Ω–∫—Ü–∏–∏:</strong></li>
                        <ul>
                            <li>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</li>
                            <li>–ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</li>
                            <li>–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–∞—è–≤–æ–∫</li>
                            <li>–ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª–µ–π</li>
                        </ul>
                    </ul>
                </div>
            </div>

            <div class="result-box" id="resultBox" style="display: none;">
                <pre id="resultContent"></pre>
            </div>
        </div>

        <div class="bot-card">
            <h5>üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</h5>
            <div class="row">
                <div class="col-md-6">
                    <h6>1. –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:</h6>
                    <ol>
                        <li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–æ—Ç–∞ –∫–Ω–æ–ø–∫–æ–π "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–æ—Ç–∞"</li>
                        <li>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ webhook –∫–Ω–æ–ø–∫–æ–π "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Webhook"</li>
                        <li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å webhook</li>
                    </ol>
                </div>
                <div class="col-md-6">
                    <h6>2. –†–∞–±–æ—Ç–∞ —Å –∑–∞—è–≤–∫–∞–º–∏:</h6>
                    <ul>
                        <li>–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</li>
                        <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</li>
                        <li>–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function showResult(data) {
            const resultBox = document.getElementById('resultBox');
            const resultContent = document.getElementById('resultContent');
            
            resultContent.textContent = JSON.stringify(data, null, 2);
            resultBox.style.display = 'block';
            
            // –ê–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                resultBox.style.display = 'none';
            }, 30000);
        }

        function showError(message) {
            showResult({
                error: true,
                message: message,
                timestamp: new Date().toISOString()
            });
        }

        async function testBot() {
            try {
                const response = await fetch('/admin/telegram/test');
                const data = await response.json();
                showResult(data);
                
                if (data.success) {
                    document.getElementById('botStatus').className = 'status-badge bg-success text-white';
                    document.getElementById('botStatus').innerHTML = '‚úÖ @broner161_bot';
                } else {
                    document.getElementById('botStatus').className = 'status-badge bg-danger text-white';
                    document.getElementById('botStatus').innerHTML = '‚ùå @broner161_bot';
                }
            } catch (error) {
                showError('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: ' + error.message);
            }
        }

        async function setWebhook() {
            try {
                const response = await fetch('/admin/telegram/set-webhook', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]')?.getAttribute('content') || ''
                    }
                });
                const data = await response.json();
                showResult(data);
            } catch (error) {
                showError('–û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ webhook: ' + error.message);
            }
        }

        async function getWebhookInfo() {
            try {
                const response = await fetch('/admin/telegram/webhook-info');
                const data = await response.json();
                showResult(data);
            } catch (error) {
                showError('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏: ' + error.message);
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            testBot();
        });
    </script>
</body>
</html>
